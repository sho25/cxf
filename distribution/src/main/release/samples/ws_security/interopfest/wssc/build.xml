<project name="wssec11" default="download">
    <property name="build.dir" location="target"/>
    <property name="baseLocation" value="http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversation.svc"/>
    

    <target name="download.internal" if="needsToDownload">
        <mkdir dir="${build.dir}/generated/src/main/resources/certs"/>
        <mkdir dir="${build.dir}/wsdl"/>
        <get src="http://131.107.72.15/ilab/Certs/Certs.zip" dest="${build.dir}/Certs.zip"/>
        <get src="${baseLocation}?wsdl" dest="${build.dir}/wsdl/WSSecureConversation.wsdl"/>
        <get src="${baseLocation}?wsdl=wsdl0" dest="${build.dir}/wsdl/WSSecureConversation_policy.wsdl"/>
        <get src="${baseLocation}?xsd=xsd0" dest="${build.dir}/wsdl/WSSecureConversation_0.xsd"/>
        <get src="${baseLocation}?xsd=xsd1" dest="${build.dir}/wsdl/WSSecureConversation_1.xsd"/>
        <get src="${baseLocation}?xsd=xsd2" dest="${build.dir}/wsdl/WSSecureConversation_2.xsd"/>
        <get src="${baseLocation}?xsd=xsd3" dest="${build.dir}/wsdl/WSSecureConversation_3.xsd"/>
        <antcall target="transform"/>
        <unzip src="${build.dir}/Certs.zip" dest="${build.dir}/generated/src/main/resources/certs"/>
    </target>

    <target name="transform">
        <mkdir dir="${build.dir}/wsdl2"/>
        <xslt basedir="${build.dir}/wsdl" destdir="${build.dir}/wsdl2"
            style="src/style/makelocal.xsl" extension=".xml">
            <mapper type="identity"/>
        </xslt>
    </target>


    <target name="download">
        <mkdir dir="${build.dir}"/>
        <condition property="needsToDownload">
          <not>
            <available file="${build.dir}/Certs.zip"/>
          </not>
        </condition>
        <antcall target="download.internal"/>
    </target>
</project>
